# Exploiting PATH Variable

## What is PATH?

PATH is an environmental variable in Linux and Unix-like operating systems which specifies directories that hold executable programs. When the user runs any command in the terminal, it searches for executable files with the help of the PATH Variable in response to commands executed by a user.\


It is very simple to view the Path of the relevant user with help of the command "echo $PATH".

## How does this let us escalate privileges?

Let's say we have an SUID binary. Running it, we can see that itâ€™s calling the system shell to do a basic process like list processes with "ps". Unlike in our previous SUID example, in this situation we can't exploit it by supplying an argument for command injection, so what can we do to try and exploit this?

We can re-write the PATH variable to a location of our choosing! So when the SUID binary calls the system shell to run an executable, it runs one that we've written instead!

As with any SUID file, it will run this command with the same privileges as the owner of the SUID file! If this is root, using this method we can run whatever commands we like as root!

e.g. there's a script with suid owned by root and we can write to it. we know that it uses some command like `ls`.\
we can create a executable in for example /tmp folder named `ls` and write "/bin/bash" to it and make it executable with chomd. then we add it to PATH with `export PATH=/tmp:$PATH`. now instead of `/bin/ls`, `/tmp/ls` will execute. we run the suid script and we get a root shell.&#x20;

we can reset the path by echoing the $PATH and select the part after `/tmp:` and assign that to $PATH like `export PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:$PATH`
